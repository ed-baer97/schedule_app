<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Админка расписания</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <style>
        body { padding: 20px; background:#f8f9fa; }
        .nav-section { border-bottom: 2px solid #dee2e6; padding-bottom: 10px; margin-bottom: 20px; }
        .nav-section.active { border-bottom-color: #0d6efd; }
        .nav-section-title { font-size: 0.9rem; font-weight: 600; color: #6c757d; margin-bottom: 8px; text-transform: uppercase; }
        .nav-link-custom { margin-right: 5px; margin-bottom: 5px; }
        .nav-link-custom.active { font-weight: 600; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
    </style>
    <script>
        // Подсветка активных ссылок и секций на основе текущего URL
        document.addEventListener('DOMContentLoaded', function() {
            const currentPath = window.location.pathname;
            const links = document.querySelectorAll('.nav-link-custom');
            const adminSection = document.getElementById('adminPanelSection');
            const scheduleSection = document.getElementById('scheduleSection');
            
            // Определяем активную секцию
            if (currentPath.includes('/schedule')) {
                scheduleSection.classList.add('active');
            } else {
                adminSection.classList.add('active');
            }
            
            // Подсветка активных ссылок
            links.forEach(link => {
                const linkPath = new URL(link.href).pathname;
                if (currentPath === linkPath || 
                    (currentPath.startsWith(linkPath) && linkPath !== '/admin' && linkPath !== '/')) {
                    link.classList.add('active');
                }
            });
            
            // Специальная обработка для главной страницы
            if (currentPath === '/admin' || currentPath === '/admin/') {
                const mainLink = document.querySelector('a[href="/admin"]');
                if (mainLink) {
                    mainLink.classList.add('active');
                }
            }
        });
    </script>
</head>
<body>
    <div class="container-fluid">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h1 class="text-primary mb-0">Админ-панель расписания</h1>
            <div>
                <span class="text-muted me-3">Вы вошли как: <strong>{% if current_user %}{{ current_user.full_name }}{% endif %}</strong></span>
                <a href="{{ url_for('logout') }}" class="btn btn-outline-danger btn-sm">
                    <i class="bi bi-box-arrow-right"></i> Выход
                </a>
            </div>
        </div>
        
        <!-- Навигация: Админ панель -->
        <div class="nav-section" id="adminPanelSection">
            <div class="nav-section-title">
                <i class="bi bi-gear"></i> Админ панель
            </div>
            <div class="btn-group flex-wrap">
                <a href="/admin" class="btn btn-outline-primary nav-link-custom">
                    <i class="bi bi-house"></i> Главная
                </a>
                <a href="/admin/teachers" class="btn btn-outline-secondary nav-link-custom">
                    <i class="bi bi-people"></i> Учителя
                </a>
                <a href="/admin/subjects" class="btn btn-outline-primary nav-link-custom">
                    <i class="bi bi-book"></i> Предметы
                </a>
                <a href="/admin/cabinets" class="btn btn-outline-primary nav-link-custom">
                    <i class="bi bi-door-open"></i> Кабинеты
                </a>
                <a href="/admin/classes" class="btn btn-outline-primary nav-link-custom">
                    <i class="bi bi-mortarboard"></i> Классы
                </a>
                <a href="/admin/class-loads" class="btn btn-outline-primary nav-link-custom">
                    <i class="bi bi-calendar-check"></i> Нагрузка классов
                </a>
                <a href="/admin/teacher-workload" class="btn btn-outline-secondary nav-link-custom">
                    <i class="bi bi-person-check"></i> Нагрузка учителей
                </a>
                <a href="/admin/upload" class="btn btn-success nav-link-custom">
                    <i class="bi bi-upload"></i> Загрузить Excel
                </a>
            </div>
        </div>
        
        <!-- Навигация: Расписание -->
        <div class="nav-section" id="scheduleSection">
            <div class="nav-section-title">
                <i class="bi bi-calendar-week"></i> Расписание
            </div>
            <div class="btn-group flex-wrap">
                <a href="/admin/schedule" class="btn btn-outline-info nav-link-custom">
                    <i class="bi bi-calendar3"></i> Расписание
                </a>
            </div>
        </div>
        {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
            {% for category, message in messages %}
              <div class="alert alert-{{ 'danger' if category=='error' else category }} alert-dismissible fade show">
                {{ message }}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
              </div>
            {% endfor %}
          {% endif %}
        {% endwith %}
        {% block content %}{% endblock %}
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>